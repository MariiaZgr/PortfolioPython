# Краткое описание проекта Foodgram

Приложение «Продуктовый помощник» - сайт, на котором пользователи могут публиковать рецепты, добавлять чужие рецепты в избранное и подписываться на публикации других авторов. 

Сервис «Список покупок» позволит пользователям создавать список продуктов, которые нужно купить для приготовления выбранных блюд. 


# Использованные технологии 

Стек технологий: Python 3, Django, Django Rest, React, Docker, PostgreSQL, nginx, Djoser.

Веб-сервер: nginx  
Frontend фреймворк: React  
Backend фреймворк: Django  
API фреймворк: Django REST  
База данных: PostgreSQL

# Сервисы и страницы проекта

## Главная страница
Содержимое главной страницы — список первых шести рецептов, отсортированных по дате публикации (от новых к старым).  

## Страница рецепта
На странице — полное описание рецепта. Для авторизованных пользователей — возможность добавить рецепт в избранное и в список покупок, возможность подписаться на автора рецепта.

## Страница пользователя
На странице — имя пользователя, все рецепты, опубликованные пользователем и возможность подписаться на пользователя.

## Подписка на авторов
Подписка на публикации доступна только авторизованному пользователю. Страница подписок доступна только владельцу.

Сценарий поведения пользователя:
Пользователь переходит на страницу другого пользователя или на страницу рецепта и подписывается на публикации автора кликом по кнопке `Подписаться на автора`.
Пользователь переходит на страницу `Мои подписки` и просматривает список рецептов, опубликованных теми авторами, на которых он подписался. 

При необходимости пользователь может отказаться от подписки на автора: переходит на страницу автора или на страницу его рецепта и нажимает `Отписаться от автора`.

## Список избранного
Работа со списком избранного доступна только авторизованному пользователю. Список избранного может просматривать только его владелец.

Сценарий поведения пользователя:

Пользователь отмечает один или несколько рецептов кликом по кнопке `Добавить в избранное`.
Пользователь переходит на страницу `Список избранного` и просматривает персональный список избранных рецептов.
При необходимости пользователь может удалить рецепт из избранного.

## Список покупок
Работа со списком покупок доступна авторизованным пользователям. Список покупок может просматривать только его владелец.

Сценарий поведения пользователя:

Пользователь отмечает один или несколько рецептов кликом по кнопке `Добавить в покупки`.
Пользователь переходит на страницу Список покупок, там доступны все добавленные в список рецепты. Пользователь нажимает кнопку `Скачать список` и получает файл с суммированным перечнем и количеством необходимых ингредиентов для всех рецептов, сохранённых в Списке покупок.
При необходимости пользователь может удалить рецепт из списка покупок.

## Фильтрация по тегам
При нажатии на название тега выводится список рецептов, отмеченных этим тегом. Фильтрация может проводится по нескольким тегам в комбинации «или»: если выбраны несколько тегов — в результате должны быть показаны рецепты, которые отмечены хотя бы одним из этих тегов. 

# Пользовательские роли и права доступа:

## Что могут делать неавторизованные пользователи
- Создать аккаунт.
- Просматривать рецепты на главной.
- Просматривать отдельные страницы рецептов.
- Просматривать страницы пользователей.
- Фильтровать рецепты по тегам.

## Что могут делать авторизованные пользователи
- Входить в систему под своим логином и паролем.
- Выходить из системы (разлогиниваться).
- Менять свой пароль.
- Создавать/редактировать/удалять собственные рецепты
- Просматривать рецепты на главной.
- Просматривать страницы пользователей.
- Просматривать отдельные страницы рецептов.
- Фильтровать рецепты по тегам.
- Работать с персональным списком избранного: добавлять в него рецепты или удалять их, просматривать свою страницу избранных рецептов.
- Работать с персональным списком покупок: добавлять/удалять любые рецепты, выгружать файл с количеством необходимых ингредиентов для рецептов из списка покупок.
- Подписываться на публикации авторов рецептов и отменять подписку, просматривать свою страницу подписок.

## Что может делать администратор
Администратор обладает всеми правами авторизованного пользователя.
Плюс к этому он может:
- изменять пароль любого пользователя,
- создавать/блокировать/удалять аккаунты пользователей,
- редактировать/удалять любые рецепты,
- добавлять/удалять/редактировать ингредиенты.
- добавлять/удалять/редактировать теги.

# Запуск проекта в контейнерах

Проект запускается в четырех контейнерах (nginx, PostgreSQL, Django, frontend) через docker-compose на сервере в Яндекс.Облаке. Образ с проектом берется из Docker Hub.

# Техническая информация по проекту
## Run composition
	cd /Repos/foodgram-project-react/infra
	docker compose -f dev.yml up -d

## Login to WEB (Python container) and start server
First: Run composition
	docker compose exec web bash
	cd ./src
    python -m pip install -r requirements.txt
	python ./manage.py migrate
	python ./manage.py runserver 0.0.0.0:8000

## Fill-in fixtures

Perform `Login to WEB (Python container) and start server` steps, then, before starting server do

```
python ./manage.py loaddata ../data/fixtures.json
```

Fixture contains all ingredients, 3 users (including superuser), and some recipes.

## Destroy everything
	docker compose -f dev.yml down
## Start frontend
	cd /Repos/foodgram-project-react/frontend
	nvm use v14
	npm run start

## Brew new backend container

0. `docker login -u lottabot` then `Password: paste_your_password_here`
1. cd to `/` (root of this Project)
2. `docker build ./ -f ./backend/Prod.dockerfile -t lottabot/ys_python:foodgram`
3. `docker push lottabot/ys_python:foodgram`


## Deployment

Автоматизирован, с помощью github actions.
Автоматический деплоймент не меняет базу данных (любые изменения с базой данных делаются вручную)

Проект доступен по адресу:
http://84.252.130.187/

Админка по адресу:
http://84.252.130.187:8000/admin

SuperUser is
login: admin
email: admin@admin.com
password: admin123


